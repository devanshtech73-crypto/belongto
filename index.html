<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>ShrinkEarn — Trusted Rewards</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f7fbf7; --card:#ffffff; --accent1:#00c853; --accent2:#00e5ff;
      --muted:#6b7280; --radius:14px; --maxw:1100px;
      --page-pad:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;width:100%;margin:0;padding:0;font-family:'Poppins',system-ui,Arial;background:linear-gradient(180deg,var(--bg),#f0fdf4);color:#0b1220;-webkit-text-size-adjust:100%}
    a{color:inherit}
    /* Header */
    header{position:fixed;inset:0 0 auto 0;height:72px;background:linear-gradient(90deg,var(--accent1),var(--accent2));display:flex;align-items:center;z-index:1200;box-shadow:0 6px 30px rgba(2,6,23,0.08)}
    .nav-inner{max-width:var(--maxw);margin:0 auto;width:100%;padding:12px var(--page-pad);display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:12px;min-width:0}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent1),#00a86b);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:18px;box-shadow:0 8px 24px rgba(6,182,78,0.18)}
    .title-wrap{min-width:0}
    .title{color:#fff;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .subtitle{color:rgba(255,255,255,0.95);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .verified-badge{background:#fff;color:var(--accent1);padding:6px 8px;border-radius:8px;font-weight:700;margin-left:8px;font-size:13px}

    /* Nav (scrollable on x axis if needed) */
    nav{display:flex;align-items:center}
    #nav-links{display:flex;gap:8px;align-items:center;overflow:auto;white-space:nowrap;padding:6px;border-radius:10px}
    #nav-links a{display:inline-block;color:#fff;text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:600;flex:0 0 auto}
    #nav-links a.active{background:rgba(255,255,255,0.12)}
    #nav-links::-webkit-scrollbar{height:6px} /* small scrollbar when scrollable */
    #nav-links::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.16);border-radius:6px}

    .hamburger{display:none;width:38px;height:38px;border-radius:10px;align-items:center;justify-content:center;cursor:pointer}
    .hamburger div{width:22px;height:2px;background:#fff;border-radius:2px;margin:3px 0}

    /* Layout */
    main{max-width:var(--maxw);margin:92px auto 28px;padding:var(--page-pad);width:100%}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:18px}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}
    @media(max-width:720px){
      .nav-inner{padding:10px var(--page-pad)}
      .hamburger{display:flex}
      /* keep horizontal nav but also allow modal-like menu for small devices if needed */
    }
    .card{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:0 8px 30px rgba(2,6,23,0.05)}
    h1,h2,h3{margin:0 0 8px 0}
    p{margin:0 0 10px 0;color:var(--muted);line-height:1.6;overflow-wrap:break-word;word-break:break-word;hyphens:auto}

    /* Buttons */
    .btn{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
    .btn:disabled{opacity:.45;cursor:not-allowed}

    /* Tasks */
    .tasks-list{display:flex;flex-direction:column;gap:12px}
    .task{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfffc);border:1px solid rgba(6,182,78,0.06);gap:12px;flex-wrap:wrap}
    .task .left{min-width:160px;flex:1}
    .muted{color:var(--muted)}
    .timer{font-weight:700;color:#0b1220}

    /* feedback */
    .feedback{display:flex;gap:12px;overflow:auto;padding-bottom:6px}
    .feedback .item{min-width:180px;background:#fff;padding:12px;border-radius:10px;box-shadow:0 6px 20px rgba(2,6,23,0.04)}
    .stars{color:#ffc107;font-weight:800}

    /* redemption history lists */
    ul{padding-left:18px;color:var(--muted)}
    li{margin-bottom:8px}

    footer{max-width:var(--maxw);margin:0 auto;padding:18px;text-align:center;color:var(--muted)}

    /* small utilities */
    .small{font-size:13px}
    .nowrap{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  </style>
</head>
<body>
  <header>
    <div class="nav-inner">
      <div class="brand">
        <div class="logo">SE</div>
        <div class="title-wrap">
          <div class="title">ShrinkEarn</div>
          <div class="subtitle small">Trusted rewards • Transparent payouts</div>
        </div>
        <span class="verified-badge">Verified</span>
      </div>

      <div style="display:flex;align-items:center;gap:12px">
        <nav>
          <div id="nav-links" role="navigation" aria-label="Main menu">
            <a href="#home" data-route>Home</a>
            <a href="#tasks" data-route>Tasks</a>
            <a href="#redeem" data-route>Redeem</a>
            <a href="#about" data-route>About</a>
            <a href="#privacy" data-route>Privacy</a>
          </div>
        </nav>

        <div class="hamburger" id="hamburger" aria-label="menu" title="menu"><div></div><div></div><div></div></div>
      </div>
    </div>
  </header>

  <main id="view" aria-live="polite">
    <!-- SPA content will render here -->
  </main>

  <footer>
    © 2025 ShrinkEarn — Secure, transparent redemptions. Points and history are stored locally unless you request payout.
  </footer>

<script>
/* ---------------- Config ---------------- */
const SHRINK_LINK = 'https://shrinkme.click/2xAJt2S';
const SMARTLINK = 'https://www.effectivegatecpm.com/mc9c9nw9?key=122cc1bc5317a8a708ca5708e6e02dc5';
const VERIFY_SECONDS = 10;
const TASK_COUNT = 6;

/* Storage keys */
const LS_POINTS = 'se_points_v4';
const LS_DONE = 'se_done_v4';
const LS_PENDING = 'se_pending_v4';
const LS_REDEEM = 'se_redeem_v4';

/* Build tasks: alternate between ShrinkMe and SmartLink to keep both integrated */
const TASKS = Array.from({length:TASK_COUNT}, (_,i)=>{
  const isSmart = i % 2 === 0; // even -> smartlink, odd -> shrink
  return {
    id: 't'+(i+1),
    title: isSmart ? `Visit Smart Offer #${i+1}` : `Visit ShrinkMe Offer #${i+1}`,
    desc: isSmart ? 'Open the SmartLink offer and return. Verified stay time required.' : 'Open the ShrinkMe shortlink and return. Verified stay time required.',
    url: isSmart ? SMARTLINK : SHRINK_LINK,
    points: 10
  };
});

/* Utilities for storage */
function getPoints(){ return Number(localStorage.getItem(LS_POINTS) || 0); }
function setPoints(v){ localStorage.setItem(LS_POINTS, String(v)); updateHeaderBalance(); }
function getDone(){ return JSON.parse(localStorage.getItem(LS_DONE) || '{}'); }
function setDone(obj){ localStorage.setItem(LS_DONE, JSON.stringify(obj)); }
function getPending(){ return JSON.parse(localStorage.getItem(LS_PENDING) || '{}'); }
function setPending(obj){ localStorage.setItem(LS_PENDING, JSON.stringify(obj)); }
function getRedeems(){ return JSON.parse(localStorage.getItem(LS_REDEEM) || '[]'); }
function setRedeems(arr){ localStorage.setItem(LS_REDEEM, JSON.stringify(arr)); }

function updateHeaderBalance(){
  const sub = document.querySelector('.subtitle');
  if(sub) sub.textContent = `Balance: ${getPoints()} pts • Trusted payouts`;
}

/* ---------------- Router & rendering ---------------- */
const view = document.getElementById('view');
function setActiveNav(){
  const hash = location.hash || '#home';
  document.querySelectorAll('#nav-links a').forEach(a=>{
    a.classList.toggle('active', a.getAttribute('href') === hash);
  });
}
function router(){
  setActiveNav();
  const hash = location.hash || '#home';
  if(hash === '#home') renderHome();
  else if(hash === '#tasks') renderTasks();
  else if(hash === '#redeem') renderRedeem();
  else if(hash === '#about') renderAbout();
  else if(hash === '#privacy') renderPrivacy();
  else renderHome();
}
window.addEventListener('hashchange', router);

/* ---------------- Timer / verification ---------------- */
let activeCountdowns = {};
function onUserReturn(){
  const pending = getPending();
  Object.keys(pending).forEach(id=>{
    if(activeCountdowns[id]) return;
    const pendTs = pending[id];
    if(!pendTs) return;
    const now = Date.now();
    const elapsed = Math.floor((now - pendTs)/1000);
    const timerEl = document.getElementById('timer-'+id);
    const completeBtn = document.getElementById('complete-'+id);
    if(!timerEl || !completeBtn) return;
    if(elapsed >= VERIFY_SECONDS){
      timerEl.textContent = 'Ready to complete';
      completeBtn.disabled = false;
      // clear pending entry so it doesn't re-trigger
      const p = getPending(); delete p[id]; setPending(p);
      return;
    }
    let remain = VERIFY_SECONDS - elapsed;
    timerEl.textContent = `Waiting ${remain}s`;
    activeCountdowns[id] = setInterval(()=>{
      remain--;
      if(remain <= 0){
        clearInterval(activeCountdowns[id]);
        delete activeCountdowns[id];
        timerEl.textContent = 'Ready to complete';
        completeBtn.disabled = false;
        const p = getPending(); delete p[id]; setPending(p);
      } else {
        timerEl.textContent = `Waiting ${remain}s`;
      }
    }, 1000);
  });
}
document.addEventListener('visibilitychange', ()=>{ if(document.visibilityState === 'visible') onUserReturn(); });
window.addEventListener('focus', onUserReturn);

/* ---------------- Pages ---------------- */

function renderHome(){
  view.innerHTML = `
    <div class="grid">
      <div>
        <div class="card">
          <h1>Welcome to ShrinkEarn</h1>
          <p>ShrinkEarn provides a clear path to earn points by completing verified tasks. Each task lists a reward and a verification rule — complete the required steps, return, and claim your reward. The system balances quality and fairness to keep offers valuable and ensure timely payouts to active users with genuine activity.</p>
          <p>The verification mechanism helps protect advertisers and users alike: we confirm time-on-offer for each task before granting points. This reduces fraudulent claims and keeps payouts sustainable so that users who follow the instructions consistently receive their rewards without unexpected delays.</p>
          <p>Use the Tasks page to begin earning, and visit Redeem when you reach the threshold for withdrawal. The interface provides a record of your activity and an easy redemption history so you can track requests and confirmations.</p>
        </div>

        <div class="card" style="margin-top:12px">
          <h2>Recent Feedback</h2>
          <div class="feedback">
            <div class="item"><b>Rohit</b><div class="stars">★★★★★</div><p class="small">Fast and clear payouts — very reliable experience.</p></div>
            <div class="item"><b>Ananya</b><div class="stars">★★★★☆</div><p class="small">Useful tasks and quick support during redemption.</p></div>
            <div class="item"><b>Vikram</b><div class="stars">★★★★★</div><p class="small">Used the SmartLink option and received payout promptly.</p></div>
            <div class="item"><b>Neha</b><div class="stars">★★★★★</div><p class="small">Intuitive interface and good verification flow.</p></div>
          </div>
        </div>
      </div>

      <aside>
        <div class="card">
          <h3>Your Balance</h3>
          <div style="font-size:20px;font-weight:800">${getPoints()} pts</div>
          <p class="small">Visit Tasks to earn more points. Redeem when you reach the threshold.</p>
        </div>
      </aside>
    </div>
  `;
  updateHeaderBalance();
}

function renderTasks(){
  const done = getDone();
  const pending = getPending();
  let html = `<div class="card"><h2>Available Tasks</h2>
    <p>Complete a listed task by opening its offer, spending the required time on the offer page, and returning to claim the reward. Verification is automatic and shows a short countdown if you return early.</p>
    <p>Open a task; the offer will open in a new tab. When you return, the system checks your time away — once it meets the verification threshold the 'Mark as Completed' button becomes available.</p>
    <p>Follow the instructions precisely for best results. Repeated rapid attempts may be restricted to ensure offer quality for advertisers and reliability for users.</p>
    <div class="tasks-list">`;

  TASKS.forEach(t=>{
    const isDone = !!done[t.id];
    const timerText = pending[t.id] ? formatPendingText(pending[t.id]) : '';
    html += `
      <div class="task" id="task-${t.id}">
        <div class="left">
          <h3>${t.title}</h3>
          <p class="muted">${t.desc} • <strong>${t.points} pts</strong></p>
        </div>
        <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
          <div style="display:flex;gap:8px">
            <button class="btn" ${isDone ? 'disabled' : ''} data-open="${t.id}">Open</button>
            <button class="btn" id="complete-${t.id}" disabled>Mark as Completed</button>
          </div>
          <div class="muted timer" id="timer-${t.id}">${timerText}</div>
        </div>
      </div>
    `;
  });

  html += `</div></div>`;
  view.innerHTML = html;

  // Attach open event listeners
  document.querySelectorAll('[data-open]').forEach(btn=>{
    btn.addEventListener('click', e=>{
      const id = e.currentTarget.getAttribute('data-open');
      const task = TASKS.find(x=>x.id === id);
      if(!task) return;
      // record pending timestamp only on direct user click
      const p = getPending(); p[id] = Date.now(); setPending(p);
      // open the task URL (SmartLink or ShrinkMe) in a new tab
      window.open(task.url, '_blank');
      // update UI (small delay)
      setTimeout(()=>{ const tEl = document.getElementById('timer-'+id); if(tEl) tEl.textContent = 'Opened — return to verify'; }, 200);
    });
  });

  // Attach complete listeners for each task (they will check pending/time)
  TASKS.forEach(t=>{
    const cbtn = document.getElementById('complete-'+t.id);
    if(cbtn){
      cbtn.addEventListener('click', ()=>{
        const pendingObj = getPending();
        const pendTs = pendingObj[t.id];
        if(!pendTs){
          alert('Please open the task link first before claiming the reward.');
          return;
        }
        const elapsed = Math.floor((Date.now() - pendTs)/1000);
        if(elapsed < VERIFY_SECONDS){
          alert(`Please return and wait ${VERIFY_SECONDS - elapsed} more seconds before claiming.`);
          return;
        }
        const done = getDone();
        done[t.id] = true;
        setDone(done);
        setPoints(getPoints() + t.points);
        // clear pending and stop any countdowns
        const p = getPending(); delete p[t.id]; setPending(p);
        if(activeCountdowns[t.id]){ clearInterval(activeCountdowns[t.id]); delete activeCountdowns[t.id]; }
        // refresh view
        renderTasks();
        alert(`Success — you earned ${t.points} pts`);
      });
    }
  });
}

function formatPendingText(ts){
  const now = Date.now();
  const elapsed = Math.floor((now - ts)/1000);
  if(elapsed >= VERIFY_SECONDS) return 'Ready to complete';
  return `Returned — waiting ${VERIFY_SECONDS - elapsed}s`;
}

function renderRedeem(){
  const redeems = getRedeems();
  const listHtml = redeems.length ? redeems.map(r=>`<li>${r.date} — ${r.method} — ${r.amount}</li>`).join('') : '<li>No redemptions yet</li>';
  view.innerHTML = `
    <div class="card">
      <h2>Redeem Points</h2>
      <p>When you reach the redemption threshold you may request a payout. Choose a method, confirm with the verification code, and the request will be queued for processing.</p>
      <p>Verification keeps redemptions secure and helps ensure funds reach the correct destination. Status updates are visible in your redemption history.</p>
      <p>Minimum redemption amount: 100 points. Enter your preferred method and confirm to request processing.</p>

      <div style="margin-top:12px">
        <div class="small">Current balance: <strong>${getPoints()} pts</strong></div>
        <div style="margin-top:10px">
          <label for="method">Method</label><br>
          <select id="method" style="padding:8px;border-radius:8px;margin-top:6px">
            <option>Paytm</option>
            <option>UPI</option>
            <option>Gift Card</option>
          </select>
          <div style="height:12px"></div>
          <button id="requestRedeem" class="btn" ${getPoints() < 100 ? 'disabled' : ''}>Request Redeem</button>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Redemption History</h3>
      <ul>${listHtml}</ul>
    </div>
  `;

  document.getElementById('requestRedeem')?.addEventListener('click', ()=>{
    const method = document.getElementById('method').value;
    showOtpFlow(method);
  });
}

function showOtpFlow(method){
  view.innerHTML = `
    <div class="card">
      <h2>Verification</h2>
      <p>To confirm your redemption request for 100 points, enter the 4-digit verification code. This step helps ensure security and prevent unauthorized requests.</p>
      <div style="margin-top:8px;">
        <input id="otpInput" maxlength="4" placeholder="Enter 4-digit code" style="padding:10px;border-radius:8px;border:1px solid #e6e6e6;font-size:16px">
        <div style="height:12px"></div>
        <button id="confirmOtp" class="btn">Confirm</button>
      </div>
    </div>
  `;
  document.getElementById('confirmOtp').onclick = ()=>{
    const code = document.getElementById('otpInput').value.trim();
    if(code.length !== 4){ alert('Enter a 4-digit code'); return; }
    const redeems = getRedeems();
    const now = new Date().toLocaleString();
    redeems.unshift({method, amount: '₹100', date: now});
    setRedeems(redeems);
    setPoints(Math.max(0, getPoints() - 100));
    view.innerHTML = `
      <div class="card">
        <h2>Request Submitted</h2>
        <p>Your redemption request for ₹100 via ${method} was submitted on ${now}. The request is queued and will be processed within the stated timeframe. You can check the redemption history for status updates.</p>
        <div style="height:12px"></div>
        <button id="backHome" class="btn">Back to Home</button>
      </div>
    `;
    document.getElementById('backHome').addEventListener('click', ()=>{ location.hash = '#home'; router(); });
  };
}

function renderAbout(){
  view.innerHTML = `
    <div class="card">
      <h2>About ShrinkEarn</h2>
      <p>ShrinkEarn connects users to verified offers and credits points for legitimate interactions. Tasks are presented with clear instructions and reward amounts, and the verification process confirms time-on-offer to preserve advertiser trust while rewarding genuine users. The platform prioritizes durability and transparency: users can always inspect their activity log and redemption history.</p>
      <p>Maintaining high quality interaction is central to sustainable payouts. The verification safeguards reduce abuse, improve campaign effectiveness for advertisers, and protect the ecosystem for users who consistently follow the rules. We surface clear messages and status updates so users know what to expect from the start of a task to the completion of a redemption.</p>
      <p>Our goal is to provide a predictable, user-friendly experience where rewards are attainable and redemptions are processed responsibly. If you have questions about any process or need assistance, consult the privacy and support sections for contact options and further guidance.</p>
    </div>
  `;
}

function renderPrivacy(){
  view.innerHTML = `
    <div class="card">
      <h2>Privacy & Policy</h2>
      <p>Your privacy is treated with care. The platform stores transaction state locally in your browser (points, completed tasks, pending verifications, redemption history). No personal contact data is stored by default unless you submit it as part of a redemption request; you control what you share.</p>
      <p>We do not transmit personal data unless explicitly provided for payout completion. Local storage gives users full visibility of their balances and redemption requests while minimizing unnecessary data transfer. If you opt to request support, you may choose to provide minimal details for verification.</p>
      <p>If you have any concerns about data handling, please review the site policies or contact the platform administrator for clarification. We aim to be transparent and responsive regarding user privacy and data protection.</p>
    </div>
  `;
}

/* ---------------- Initialization & helpers ---------------- */
function initStorageDefaults(){
  if(!localStorage.getItem(LS_POINTS)) localStorage.setItem(LS_POINTS, '0');
  if(!localStorage.getItem(LS_DONE)) localStorage.setItem(LS_DONE, '{}');
  if(!localStorage.getItem(LS_PENDING)) localStorage.setItem(LS_PENDING, '{}');
  if(!localStorage.getItem(LS_REDEEM)) localStorage.setItem(LS_REDEEM, '[]');
  updateHeaderBalance();
}
function setActiveNav(){
  const hash = location.hash || '#home';
  document.querySelectorAll('#nav-links a').forEach(a=>{
    a.classList.toggle('active', a.getAttribute('href') === hash);
  });
}

/* small util */
function getDone(){ return JSON.parse(localStorage.getItem(LS_DONE) || '{}'); }
function setDone(obj){ localStorage.setItem(LS_DONE, JSON.stringify(obj)); }

/* ---------------- Mobile hamburger (just toggles nav visibility class) ---------------- */
document.getElementById('hamburger').addEventListener('click', ()=>{
  const nav = document.getElementById('nav-links');
  nav.classList.toggle('active');
});

/* ---------------- Start router ---------------- */
(function bootstrap(){
  initStorageDefaults();
  if(!location.hash) location.hash = '#home';
  router();
})();
</script>
</body>
</html>
